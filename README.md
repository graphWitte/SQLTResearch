# Лабораторная работа №1
## Прокат автомобилей. (вариант 22)
Фирма выдает напрокат автомобили. Информация об автомобиле (модель,
цвет, год выпуска, госномер, стоимость одного дня проката). Информация о
клиенте (ФИО, серия и номер паспорта). Накапливается информация о
прокатах, где накапливается информация о дате начала проката и количестве
дней проката. Стоимость одного дня проката может отличаться для разных
автомобилей.
Выходные документы.
 - Список прокатных документов за определенный период с указанием
стоимости проката и страхового взноса. Стоимость проката автомобиля
определяется как Стоимость одного дня проката · Количество дней
проката. Фирма ежегодно страхует автомобили, выдаваемые клиентам.
Страховой взнос, выплачиваемый фирмой, равен 10 процентам от
страховой стоимости автомобиля.
 - Список автомобилей, упорядоченный по моделям, а для каждой модели
 по убыванию года выпуска.
### ER-диаграмма (рис. 1)
![ER-диаграмма](jpges/ERdiagram.PNG)

# Лабораторная работа №2
## Логическая модель
 ### Сущность Clients
- Назначение: хранение информации о клиентах
- атрибуты:
- - id - уникальный идентификатор клиента
- - full_name - ФИО
- - passport - паспортные данные
 ### Сущность Cars
- Назначение: хранение информации об автомобилях
- Атрибуты:
- - id - уникальный идентификатор автомбиля
- - model - модель
- - color - цвет
- - year - год выпуска
- - license_plate - гос. номер
- - current_daily_price - цена за день аренды
### Сущность Rentals
- Назначение: хранение информации о прокатах
- Атрибуты:
- - id - Уникальный идентификатор проката
- - client_id - ссылка на клиента
- - car_id — ссылка на автомобиль
- - start_date — дата начала проката
- - days_count — количество дней
- - price_at_rental - зафиксированная стоимость одного дня проката на момент оформления (для истории)
### Сущность Insurances
- Назначение: хранение информации о страховании автомобилей.
- Атрибуты:
- - id — уникальный идентификатор записи
- - car_id — ссылка на автомобиль
- - insurance_value — страховая стоимость автомобиля
- - insurance_year — год страхования
## Физическая модель
![Физическая модель](jpges/fizmod.png)
## DDL Запросы
### Создаем таблицы
![Orders](jpges/soz1.png)
### Заполняем таблицы
![Заполняем](jpges/zaptab.png)
## SELECT запросы
Список прокатов с расчетами (страховой взнос 10% от оценочной стоимости авто)
![Прокаты и расчеты](jpges/select1.png)
Список автомобилей и сортировка (А-Я + от новых к старым)
![Список](jpges/select2.png)
# Лабораторная работа 3
## Создание представлений
### Представление для отчета по прокатам
![..](jpges/lab3.1.png)
проверяем
![Прокаты и расчеты](jpges/lab3.2.png)
### Представление для списка авто
![Прокаты и расчеты](jpges/lab3.3.png)
проверяем
![Прокаты и расчеты](jpges/lab3.4.png)
## Процедуры
### Оформление проката
![Прокаты и расчеты](jpges/lab3.5.png)
проверяем, сдаем машину №1 клиенту №2 на 5 дней
![Прокаты и расчеты](jpges/lab3.6.png)
![Прокаты и расчеты](jpges/lab3.7.png)
### Изменение цены авто
![Прокаты и расчеты](jpges/lab3.8.png)
меняем стоимость машины 1 на 9999 рублей
![Прокаты и расчеты](jpges/lab3.9.png)
![Прокаты и расчеты](jpges/lab3.10.png)
# Лабораторная работа 4
## Создаю генераторы, которые заполнят таблицы
### Генератор данных
![Генератор](jpges/Generator.png)
смотрим до оптимизации
![до оптимизации](jpges/GenDoOptim.png)
Добавляю оглавление по стоблцу car_id
![оптимизация](jpges/Optim.png)
Теперь как выглядит после оптимизации
![ВАУ!](jpges/wow.png)
Исходя из данных таблицы, мы видим, что время выполнения запроса сократилось до 0.080 мс. Это более чем в 100 раз быстрее в отличие от первого запроса.
# Лабораторная работа 5
## Создание триггера
### При удалении машины триггер будет удалять все её страховки
![Триггерим](jpges/trigger.png)
### Универсальный аудит
Журнал, в котором будем писать всё, что происходит с таблицей Clients
Журнал для аудита
![Журнал](jpges/lab5.2.png)
Функция Аудита (запись изменений)
![Генератор](jpges/lab5func.png)
Триггер на таблице
![Триггер на таблице](jpges/trigger2.png)
### финальная проверка
![ИТОООГ](jpges/itog.png)